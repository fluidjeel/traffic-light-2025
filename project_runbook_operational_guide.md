# Project Runbook & Operational Guide

This document provides the Standard Operating Procedure (SOP) for running the Nifty 200 Pullback Strategy's research pipeline. Following these steps in order is critical for generating accurate and comparable backtest results.

---

### **Step 1: Data Acquisition**

**Objective:** To ensure you have the latest raw daily and 15-minute price data for all Nifty 200 stocks and the index.

**Procedure:**

1.  **Authenticate with Fyers:** Before running any scraper for the first time in a day, you will likely need to re-authenticate. A simple way to ensure this is to delete the `fyers_access_token.txt` file from your project directory.
2.  **Run the Daily Scraper:** Execute the following command in your terminal:
    ```bash
    python fyers_equity_scraper.py
    ```
    This will incrementally update your `historical_data/` folder with the latest daily data.
3.  **Run the 15-Minute Equity Scraper:** Execute the following command:
    ```bash
    python fyers_equity_scraper_15min.py
    ```
    This will update your `historical_data_15min/` folder with the latest 15-minute equity data.
4.  **Run the 15-Minute Index Scraper:** Execute the following command:
    ```bash
    python fyers_nifty200_index_scraper_15min.py
    ```
    This will update your `historical_data_15min/` folder with the latest 15-minute index data.

---

### **Step 2: Data Processing**

**Objective:** To process the raw daily data and generate the clean, indicator-rich files needed by the backtesters.

**Procedure:**

1.  **Clean the Output Directory:** Before running, it is best practice to delete the entire `data/processed/` directory to ensure you are starting with a fresh slate.
2.  **Run the Indicator Calculator:** Execute the following command:
    ```bash
    python calculate_indicators_clean.py
    ```
    This script will read the raw daily data, create all higher timeframes (2-day, weekly, monthly), calculate all necessary indicators, and save the final, clean files to the `data/processed/` directory.

---

### **Step 3: Generate the "Golden Benchmark"**

**Objective:** To run the original, flawed backtester to generate the "perfect" trade log that serves as our performance benchmark.

**Procedure:**

1.  **Configure the Script:** Open `final_backtester_benchmark_logger.py` and ensure the `timeframe` in the `config` dictionary is set to `'daily'`.
2.  **Execute the Backtest:** Run the following command:
    ```bash
    python final_backtester_benchmark_logger.py
    ```
3.  **Review the Output:** The script will generate three files in your `backtest_logs/` directory. The most important is the `..._all_setups_log.csv` file. This is your Golden Benchmark.

---

### **Step 4: Run the Realistic Hybrid Backtest**

**Objective:** To run the current state-of-the-art, realistic backtester and compare its performance to the benchmark.

**Procedure:**

1.  **Configure the Script:** Open `final_backtester_v8_hybrid_optimized.py`. You can adjust any parameters in the `config` dictionary, such as `risk_per_trade_percent` or toggling the intraday filters on and off.
2.  **Execute the Backtest:** Run the following command:
    ```bash
    python final_backtester_v8_hybrid_optimized.py
    ```
3.  **Review and Compare:** The script will generate its own set of logs in the `backtest_logs/` directory. The primary task is now to compare the "REALISTIC PERFORMANCE" section of its summary report to the one generated by the benchmark logger to analyze the performance gap.
